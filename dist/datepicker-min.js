class DatePicker{constructor(e,t={}){this.inputElement=e,this.selectedDate=t.initialDate?new Date(t.initialDate):null,this.selectedYear=this.selectedDate?this.selectedDate.getFullYear():null,this.selectedMonth=this.selectedDate?this.selectedDate.getMonth():null,this.today=new Date,console.log(this.selectedDate,this.selectedYear,this.selectedMonth),this.dateFormat=t.dateFormat||"yyyy-mm-dd",this.minDate=t.minDate?new Date(t.minDate):null,this.maxDate=t.maxDate?new Date(t.maxDate):null,this.mobileLayout=t.mobileBreakPoint||679,this.setup()}static initializeDatePicker(){DatePicker.datepicker||(DatePicker.backdrop=document.createElement("div"),DatePicker.backdrop.setAttribute("yawdc-datepicker-backdrop",""),DatePicker.datepicker=document.createElement("div"),DatePicker.datepicker.classList.add("yawdc-datepicker"),DatePicker.datepicker.innerHTML="<div yawdc-datepicker-header><div yawdc-normal-header><select hidden yawdc-month-select-hidden></select> <select hidden yawdc-year-select-hidden></select><div yawdc-datepicker-year-month><button yawdc-action-button yawdc-month-select></button> <button yawdc-action-button yawdc-year-select></button></div></div><div yawdc-year-header>Select a year</div><div yawdc-month-header>Select a month</div></div><div yawdc-datepicker-calendar><div yawdc-datepicker-weekdays><span>S</span><span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span></div><div yawdc-datepicker-days></div></div><div style=overflow-y:auto yawdc-datepicker-years></div><div class=month-grid yawdc-datepicker-months></div>",document.body.appendChild(DatePicker.backdrop),document.body.appendChild(DatePicker.datepicker),DatePicker.datepicker.addEventListener("click",e=>{e.stopPropagation()}),DatePicker.yearSelect=DatePicker.datepicker.querySelector("[yawdc-year-select-hidden]"),DatePicker.monthSelect=DatePicker.datepicker.querySelector("[yawdc-month-select-hidden]"),DatePicker.headerNormal=DatePicker.datepicker.querySelector("[yawdc-normal-header]"),DatePicker.headerYear=DatePicker.datepicker.querySelector("[yawdc-year-header]"),DatePicker.headerMonth=DatePicker.datepicker.querySelector("[yawdc-month-header]"),DatePicker.yearView=DatePicker.datepicker.querySelector("[yawdc-datepicker-years]"),DatePicker.monthView=DatePicker.datepicker.querySelector("[yawdc-datepicker-months]"),DatePicker.calendarView=DatePicker.datepicker.querySelector("[yawdc-datepicker-calendar]"),DatePicker.yearSelect.addEventListener("change",()=>{DatePicker.activeInstance&&(DatePicker.activeInstance.selectedYear=parseInt(DatePicker.yearSelect.value),DatePicker.activeInstance.renderCalendar())}),DatePicker.monthSelect.addEventListener("change",()=>{DatePicker.activeInstance&&(DatePicker.activeInstance.selectedMonth=parseInt(DatePicker.monthSelect.value),DatePicker.activeInstance.renderCalendar())}))}setup(){DatePicker.initializeDatePicker(),this.setupListeners(),this.disableInputSuggestions(),this.addIcon()}setupListeners(){this.inputElement.addEventListener("click",e=>{e.stopPropagation(),this.closeAllDatePickers(),DatePicker.activeInstance=this,this.openDatePicker()}),document.addEventListener("click",e=>{DatePicker.datepicker.contains(e.target)||e.target===this.inputElement||this.closeDatePicker()}),DatePicker.headerNormal.querySelector("[yawdc-datepicker-year-month] [yawdc-year-select]").addEventListener("click",e=>{this.hide(DatePicker.calendarView),this.showYearGrid(!0)}),DatePicker.headerNormal.querySelector("[yawdc-datepicker-year-month] [yawdc-month-select]").addEventListener("click",e=>{this.hide(DatePicker.calendarView),this.showMonthGrid(!0)})}openDatePicker(){DatePicker.datepicker.classList.add("visible"),this.positionDatePicker(),this.shouldTriggerMobileLayout(),this.renderInitialView()}closeDatePicker(){DatePicker.datepicker.classList.remove("visible"),DatePicker.backdrop.classList.remove("visible"),document.body.classList.remove("yawdc-datepicker-open"),this.resetDatePickerStyles()}shouldTriggerMobileLayout(){let e=document.documentElement.clientWidth;e<=this.mobileLayout?(document.body.classList.add("yawdc-datepicker-open"),DatePicker.datepicker.style.top=`calc(50% + ${window.scrollY}px)`,DatePicker.datepicker.style.left=0,DatePicker.datepicker.style.right=0,DatePicker.datepicker.style.margin="auto",DatePicker.datepicker.style.transform="translateY(-50%)",DatePicker.backdrop.classList.add("visible")):(this.resetDatePickerStyles(),document.body.classList.remove("yawdc-datepicker-open"))}resetDatePickerStyles(){DatePicker.datepicker.style.right=null,DatePicker.datepicker.style.margin=null,DatePicker.datepicker.style.transform=null}closeAllDatePickers(){DatePicker.activeInstance=null,this.closeDatePicker()}positionDatePicker(){let e=this.inputElement.getBoundingClientRect();DatePicker.datepicker.style.top=`${e.bottom+window.scrollY}px`,DatePicker.datepicker.style.left=`${e.left+window.scrollX}px`}renderInitialView(){this.populateYearSelect(),this.populateMonthSelect(),this.selectedDate?(this.show(DatePicker.headerNormal),this.hide(DatePicker.headerMonth),this.hide(DatePicker.headerYear),this.renderCalendar(),this.setCalendarHeader(),this.hide(DatePicker.monthView),this.hide(DatePicker.yearView)):(this.hide(DatePicker.headerNormal),this.hide(DatePicker.headerMonth),this.show(DatePicker.headerYear),this.hide(DatePicker.monthView),this.hide(DatePicker.calendarView),this.showYearGrid())}setCalendarHeader(){let e=this.getMonths()[this.selectedMonth],t=this.selectedYear;DatePicker.headerNormal.querySelector("[yawdc-datepicker-year-month] [yawdc-month-select]").innerHTML=`${e}`,DatePicker.headerNormal.querySelector("[yawdc-datepicker-year-month] [yawdc-year-select]").innerHTML=`${t}`}showYearGrid(e=!1){this.hide(DatePicker.monthView);let t=DatePicker.yearView;t.innerHTML="";let a=this.today.getFullYear(),i=this.minDate?this.minDate.getFullYear():a-10,r=this.maxDate?this.maxDate.getFullYear():a+10;for(let c=i;c<=r;c++){let d=document.createElement("div");d.classList.add("year-cell"),c!==this.selectedYear&&(c!==a||this.selectedYear)||d.classList.add("selected"),d.textContent=c,d.addEventListener("click",()=>{this.selectedYear=c,DatePicker.yearSelect.value=c,this.selectedMonth=null,this.populateMonthSelect(),this.triggerChange(DatePicker.yearSelect),e?(DatePicker.headerNormal.querySelector("[yawdc-datepicker-year-month] [yawdc-year-select]").innerHTML=`${this.selectedYear}`,this.hide(DatePicker.yearView),this.show(DatePicker.headerNormal),this.show(DatePicker.calendarView)):this.showMonthGrid()}),t.appendChild(d)}t.style.display="grid",t.scrollTop=t.querySelector(".year-cell.selected")?.offsetTop-t.clientHeight/2}showMonthGrid(e=!1){this.hide(DatePicker.yearView);let t=DatePicker.datepicker.querySelector("[yawdc-datepicker-months]");t.innerHTML="";let a=this.getMonthsShort();a.forEach((e,a)=>{let i=document.createElement("div");i.classList.add("month-cell"),i.textContent=e,i.addEventListener("click",()=>{this.selectedMonth=a,DatePicker.monthSelect.value=a,this.triggerChange(DatePicker.monthSelect),this.renderCalendar(),this.hide(DatePicker.monthView),this.show(DatePicker.calendarView);let e=this.getMonths()[a],t=this.selectedYear;DatePicker.headerNormal.querySelector("[yawdc-datepicker-year-month] [yawdc-month-select]").innerHTML=`${e}`,DatePicker.headerNormal.querySelector("[yawdc-datepicker-year-month] [yawdc-year-select]").innerHTML=`${t}`,this.show(DatePicker.headerNormal),this.hide(DatePicker.headerMonth),this.hide(DatePicker.headerYear)}),t.appendChild(i)}),t.style.display="grid",e||(this.show(DatePicker.headerMonth),this.hide(DatePicker.headerNormal),this.hide(DatePicker.headerYear))}renderCalendar(){let e=Intl.DateTimeFormat().resolvedOptions().timeZone,t=DatePicker.datepicker.querySelector("[yawdc-datepicker-days]");t.innerHTML="";let a=this.selectedYear,i=this.selectedMonth,r=new Date(a,i+1,0).getDate(),c=new Date(a,i,1).getDay();for(let d=0;d<c;d++)t.innerHTML+="<span>-</span>";for(let s=1;s<=r;s++){let l=new Date(a,i,s).toLocaleDateString("en-US",{timeZone:e}),n=this.formatDate(new Date(a,i,s),this.dateFormat),h=[];a===this.today.getFullYear()&&i===this.today.getMonth()&&s===this.today.getDate()&&h.push("today"),this.selectedDate&&a===this.selectedDate.getFullYear()&&i===this.selectedDate.getMonth()&&s===this.selectedDate.getDate()&&(console.log(s),console.log(l),h.push("selected")),t.innerHTML+=`<span class="day ${h.join(" ")}" data-date="${l}" data-formatted="${n}">${s}</span>`}t.querySelectorAll(".day").forEach(e=>{e.addEventListener("click",e=>{this.inputElement.value=e.target.dataset.formatted||e.target.dataset.date,this.selectedDate=new Date(e.target.dataset.date),this.closeDatePicker(),this.renderCalendar()})})}populateYearSelect(){DatePicker.yearSelect.innerHTML="";let e=new Date().getFullYear(),t=this.minDate?this.minDate.getFullYear():e-10,a=this.maxDate?this.maxDate.getFullYear():e+10;for(let i=t;i<=a;i++){let r=document.createElement("option");r.value=i,r.textContent=i,DatePicker.yearSelect.appendChild(r)}DatePicker.yearSelect.value=this.selectedYear}populateMonthSelect(){DatePicker.monthSelect.innerHTML="";let e=this.getMonths();e.forEach((e,t)=>{let a=document.createElement("option");a.value=t,a.textContent=e,DatePicker.monthSelect.appendChild(a)}),DatePicker.monthSelect.value=this.selectedMonth}formatDate(e,t){let a=e.getFullYear(),i=e.getMonth()+1,r=e.getDate();return t.replace("yyyy",a).replace("mm",i.toString().padStart(2,"0")).replace("dd",r.toString().padStart(2,"0"))}disableInputSuggestions(){this.inputElement.setAttribute("autocomplete","off")}triggerChange(e){e.dispatchEvent(new Event("change"))}addIcon(){let e=document.createElement("div");e.classList.add("yawdc-datepicker-wrapper"),this.inputElement.parentNode.insertBefore(e,this.inputElement),e.appendChild(this.inputElement)}getMonths(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}getMonthsShort(){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"]}show(e,t="block"){e.style.display=t}hide(e){e.style.display="none"}}